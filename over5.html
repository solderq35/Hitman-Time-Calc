<!-- Do a Find and Replace for "index" vs "over5" for findTotal() and initPage() function inputs.
  That's the only difference between index.html and over5.html.
  NOTE: For find and replace, put ' ' (and not " ") around the arg names, to avoid changing the above comment by accident.
-->

<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="icon"
      href="https://img.icons8.com/color/344/calculator--v1.png"
    />
    <script src="index.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <meta property="og:title" content="Hitman Milliseconds Time Calculator" />
    <meta property="og:description" content="" />
    <meta
      property="og:image"
      content="https://img.icons8.com/color/344/calculator--v1.png"
    />
  </head>
  <body onLoad="return (initPage('over5'), findTotal('over5'))">
    <title>HITMAN Milliseconds Time Calculator</title>
    <div class="test">
      <h2 class="h_custom" id="titleHeader">
        HITMAN Milliseconds Time Calculator
      </h2>

      <p>
        <strong class="p1">Score on Rating Screen: </strong>
        <input
          onkeyup="findTotal('over5')"
          type="text"
          id="score"
          name="printcost"
          placeholder="Enter a Score"
          class="scoreInput"
        />
      </p>
    </div>
    <div id="totalordercost"></div>
    <div id="totalordercost2"></div>
    <strong class="p1">
      Debug Mode
      <input
        type="checkbox"
        id="debugCheckbox"
        name="debug"
        value="debug"
        class="debugCheckbox"
        onclick="findTotal('over5')"
      />
    </strong>
    <br />
    <br />
    <button type="button" class="saveButton" onClick="clearFields()">
      Clear Fields
      <!-- https://www.svgrepo.com/ -->
      <svg
        width="25px"
        height="25px"
        viewBox="0 0 24 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M9 9L15 15"
          stroke="#000000"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path
          d="M15 9L9 15"
          stroke="#000000"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <circle
          cx="12"
          cy="12"
          r="9"
          stroke="#000000"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
    <button type="button" class="saveButton" onClick="saveData()">
      Save Data as URL
      <!-- https://www.svgrepo.com/ -->
      <svg
        width="25px"
        height="25px"
        viewBox="0 0 48 48"
        xmlns="http://www.w3.org/2000/svg"
      >
        <title>share-arrow</title>
        <g id="Layer_2" data-name="Layer 2">
          <g id="invisible_box" data-name="invisible box">
            <rect width="48" height="48" fill="none" />
          </g>
          <g id="Q3_icons" data-name="Q3 icons">
            <path
              d="M31.2,14.2,41,24.1l-9.8,9.8V26.8L27,27c-6.8.3-12,1-16.1,2.4,3.6-3.8,9.3-6.8,16.7-7.5l3.6-.3V14.2M28.3,6a1.2,1.2,0,0,0-1.1,1.3V17.9C12,19.4,2.2,29.8,2,40.3c0,.6.2,1,.6,1s.7-.3,1.1-1.1c2.4-5.4,7.8-8.5,23.5-9.2v9.7A1.2,1.2,0,0,0,28.3,42a.9.9,0,0,0,.8-.4L45.6,25.1a1.5,1.5,0,0,0,0-2L29.1,6.4a.9.9,0,0,0-.8-.4Z"
            />
          </g>
        </g>
      </svg>
    </button>
    <br />
    <br />
    <strong class="p1">Time Calculation (minutes:seconds.milliseconds) </strong>
    <br />
    <br />
    <b class="p2">
      <div id="time0" class="p3"></div>
      <br />
      <button type="button" class="collapsible">
        More Info on Time Calculation (Click to Expand)
      </button>
      <div class="content">
        <h3 id="mathematics-code-explanation">Mathematics/ Code Explanation</h3>
        <p>
          The full mathematical formula for calculating in game time from score,
          for runs of less than 5 minutes in-game time, is:
        </p>
        <p><strong>(210,000 - (N * 100,000 / M)) * (3 / 400)</strong></p>
        <p>
          The full mathematical formula for calculating in game time from score,
          for runs of 5 to 15 minutes, is:
        </p>
        <p><strong>(175,000 - (N * 100,000 / M)) * (3 / 50)</strong></p>
        <p>
          Let N = The Score shown on screen.<br />Let M = The Bonuses and
          Penalties added up.
        </p>
        <p>
          Each Silent Assassin Bonus (Objectives Complete, Never Spotted, No
          Noticed Kills, No Bodies Found, No Recordings) is 20k points towards
          the M value, while each nontarget kill is -5k points towards the M
          value. Note that the Time Bonus does not count towards the M value.
          The maximum M value is 100,000.
        </p>
        <p>
          <a href="https://i.ibb.co/BPPf3wn/detailedscore.png"
            >If confused by terminology in above paragraph, refer to this
            reference image of Detailed Score (press P on a Hitman mission
            rating screen to get to this menu in-game)</a
          >
        </p>
        <p>
          Since most players do not show Detailed Score Menu in their run
          submissions, this site runs a script to account for all 20 possible M
          values, and calculates 20 possible decimal times as a result. The user
          is asked to report the the time shown on the rating screen (which
          rounds down to the nearest second). The calculated decimal time that
          is closest to the time shown on the rating screen is displayed to the
          user.
        </p>
        <h3 id="usage-quirks">Usage Quirks</h3>
        <ul>
          <li>
            <p>
              This formula does not work when the N value (Score) and/or M value
              (Penalties/Bonuses) are 0. Note that one of the Silent Assassin
              bonuses is &quot;Objectives Complete&quot;, and you are almost
              guaranteed to get points for this simply by killing all targets
              and exiting the mission. The score can become 0 either due to:
            </p>
          </li>
          <li>
            <p>
              Killing too many nontargets (each nontarget kill is -5k in the
              Bonuses and Penalties (M) score).
            </p>
          </li>
          <li>
            <p>
              Finishing the mission in less than 7 seconds (IOI&#39;s
              &quot;anticheat&quot;, currently this only applies to Dubai any%
              in terms of main missions).
            </p>
          </li>
          <li>
            <p>
              Any decimal values smaller than a millisecond in the final result
              are rounded down to the nearest millisecond.
            </p>
            <ul>
              <li>Example: 26.1857 rounds down to 26.185.</li>
            </ul>
          </li>
        </ul>
        <h3 id="error-calculation">Error Calculation</h3>
        <ul>
          <li>
            Disclaimer: The calculated decimal score is not quite accurate (due
            to the game internally tracking decimals in the score). These can be
            manually rounded to the next fastest second as needed for
            leaderboard purposes.
            <ul>
              <li>
                To be precise:
                <strong>Error = (Z * 100,000 / M) * (3 / 400)</strong>
                <ul>
                  <li>
                    Where M = the penalties and bonuses added up (each SA bonus
                    20k, each nontarget kill -5k, etc).
                  </li>
                  <li>
                    And Z = how much the score shown on screen is off, between
                    -0.5 and 0.5.
                  </li>
                </ul>
              </li>
              <li>
                Assuming -0.5 &lt; Z &lt;= 0.5, the error can be as low as
                ±0.00375 seconds (for SA run) or as high as ±0.75 seconds (any%
                run with M score of 5k).
              </li>
              <li>
                Example (calculated time is higher than expected):
                <ul>
                  <li>
                    SCORE (N): 113593
                    <ul>
                      <li><strong>Actual Score Screen</strong>: 0:25.xxx</li>
                      <li>
                        Original Time Calc:
                        <a
                          href="https://www.google.com/search?q=%28210000+-+%28113593+*+100000+%2F+55000%29%29+*+%283+%2F+400%29"
                          >0:26.004</a
                        >
                      </li>
                      <li>
                        Time Calc Error Range: (<a
                          href="https://www.google.com/search?q=%28210000+-+%28113593.5+*+100000+%2F+55000%29%29+*+%283+%2F+400%29"
                          >0:25.997</a
                        >,
                        <a
                          href="https://www.google.com/search?q=%28210000+-+%28113592.5+*+100000+%2F+55000%29%29+*+%283+%2F+400%29"
                          >0:26.011</a
                        >)
                      </li>
                      <li>
                        Margin of Error (Seconds): ±
                        <a
                          href="https://www.google.com/search?q=%280.5+*+100000+%2F+55000%29+*+%283+%2F+400%29"
                          >0.00681</a
                        >
                      </li>
                      <li>M value: 55000</li>
                      <li>
                        <strong>Result for SRC</strong>: Due to the time shown
                        on rating screen taking precedent, use 25.999 for
                        leaderboard ranking (if using milliseconds)
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>
                Example (calculated time is lower than expected):
                <ul>
                  <li>
                    SCORE: 204667
                    <ul>
                      <li>
                        <strong>Actual Time shown on Rating Screen</strong>:
                        40.xxx
                      </li>
                      <li>
                        Original Time Calc:
                        <a
                          href="https://www.google.com/search?q=%28210000+-+%28204667+*+100000+%2F+100000%29%29+*+%283+%2F+400%29"
                          >0:39.997</a
                        >
                      </li>
                      <li>
                        Time Calc Error Range: (<a
                          href="https://www.google.com/search?q=%28210000+-+%28204667.5+*+100000+%2F+100000%29%29+*+%283+%2F+400%29"
                          >0:39.993</a
                        >,
                        <a
                          href="https://www.google.com/search?q=%28210000+-+%28204666.5+*+100000+%2F+100000%29%29+*+%283+%2F+400%29"
                          >0:40.001</a
                        >]
                      </li>
                      <li>
                        Margin of Error (Seconds): ±
                        <a
                          href="https://www.google.com/search?q=%280.5+*+100000+%2F+100000%29+*+%283+%2F+400%29"
                          >0.00375</a
                        >
                      </li>
                      <li>M value: 100000</li>
                      <li>
                        <strong>Result for SRC (tentative)</strong>: Due to the
                        time shown on rating screen taking precedent, use 40.000
                        for leaderboard ranking (if using milliseconds)
                      </li>
                      <li>
                        PS: This case seems to confirm that the score rounds up
                        to the next value, with a rounding cutoff near .5 mark
                        (score decimals of less than .5 = round down, greater
                        than or equal to .5 = round up)
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="BioDiv">
        <p>
          <a href="" class="p1" id="otherPage"
            >Calculator for runs of 5 to 15 minutes</a
          >
          <br />
          <br />
          <b class="p3">
            <a
              href="https://github.com/solderq35/time-calc-under-5/blob/main/README.md#usage-instructions-and-screenshots"
              class="p1"
              >Usage Instructions</a
            >
          </b>
          <br />
          <br />
          <b class="p3">
            Code by
            <a href="https://solderq35.github.io/" class="p1">Solderq35</a>
          </b>
        </p>
      </div>
      <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;
        for (i = 0; i < coll.length; i++) {
          coll[i].addEventListener("click", function () {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "block") {
              content.style.display = "none";
            } else {
              content.style.display = "block";
            }
          });
        }
      </script>
      <script>
        document.body.style.backgroundColor = "#F5F5DC";
      </script>
    </b>
  </body>
</html>
